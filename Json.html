<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Wireguard JSON Code Generator for Sing-box</title>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet">
	<style>
body
{
	font-family: Arial, sans-serif;
	background-color: #1a202c;
	color: #e2e8f0;
}

.ltr
{
	direction: ltr;
	text-align: left;
}

#jsonContainer
{
	font-size: 8px;
}

.dark-theme
{
	background-color: #2d3748;
	color: #e2e8f0;
}

.breathe
{
	animation: breathe 5s ease-in-out infinite;
}

@keyframes breathe
{

	0%,
	100%
	{
		opacity: 1;
	}
	
	50%
	{
		opacity: 0.2;
	}
}

.btn-telegram
{
	background-color: #0088cc;
	color: white;
}

.btn-telegram:hover
{
	background-color: #007bb5;
}

.success-message
{
	display: none;
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	background-color: #38a169;
	color: white;
	padding: 10px 0;
	text-align: center;
	font-weight: bold;
	box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
	animation: fadeInOut 3s forwards;
	z-index: 1000;
}

@keyframes fadeInOut
{
	0%
	{
		opacity: 0;
		transform: translateY(-20px);
	}
	
	10%
	{
		opacity: 1;
		transform: translateY(0);
	}
	
	90%
	{
		opacity: 1;
		transform: translateY(0);
	}
	
	100%
	{
		opacity: 0;
		transform: translateY(-20px);
	}
}
	</style>
</head>

<body class="min-h-screen flex items-center justify-center p-4">
	<div class="dark-theme rounded-lg shadow-xl p-8 max-w-2xl w-full relative">
		<!-- اعلان موفقیت -->
		<div id="successMessage" class="success-message"> JSON Code Generated Successfully! </div>
		<h1 class="text-2xl font-bold mb-6 text-center text-gray-300 breathe">Wireguard JSON Code Generator for Sing-box</h1>
		<div class="space-y-4">
			<button id="fetchIpButton" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105">Fetch IP and Port</button>
			<div class="space-y-4">
				<input type="text" id="ipInput" placeholder="IP" readonly class="w-full p-2 border border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-700 text-white">
				<input type="text" id="portInput" placeholder="Port" readonly class="w-full p-2 border border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-700 text-white">
			</div>
			<button id="generateJsonButton" class="w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition duration-300 ease-in-out transform hover:scale-105">Generate JSON Code</button>
			<div class="relative">
				<pre id="jsonContainer" class="ltr p-4 bg-gray-800 rounded-lg h-96"><code id="jsonOutput" class="language-json"></code></pre>
				<button id="copyJsonButton" class="absolute top-2 right-2 bg-gray-700 text-white py-1 px-3 rounded-md hover:bg-gray-600 transition duration-300 ease-in-out">Copy</button>
			</div>
		</div>
		<div class="mt-6 text-center">
			<a href="https://t.me/BXAMbot" class="inline-block btn-telegram text-white py-2 px-4 rounded-md transition duration-300 ease-in-out transform hover:scale-105">Contact Me</a>
			<p class="text-xs text-gray-400 mt-2">Designed by: Anonymous</p>
		</div>
	</div>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-json.min.js"></script>
	<script>
const fetchIpButton = document.getElementById('fetchIpButton');
const generateJsonButton = document.getElementById('generateJsonButton');
const copyJsonButton = document.getElementById('copyJsonButton');
const ipInput = document.getElementById('ipInput');
const portInput = document.getElementById('portInput');
const jsonOutput = document.getElementById('jsonOutput');
fetchIpButton.addEventListener('click', async () =>
{
	try
	{
		const response = await fetch('https://raw.githubusercontent.com/ircfspace/endpoint/refs/heads/main/ip.json');
		const data = await response.json();
		const ipList = data.ipv4;
		const randomIndex = Math.floor(Math.random() * ipList.length);
		const [ip, port] = ipList[randomIndex].split(':');
		ipInput.value = ip;
		portInput.value = port;
	}
	catch (error)
	{
		console.error('Error fetching IP:', error);
		alert('Error fetching IP. Please try again.');
	}
});
document.getElementById('generateJsonButton')
	.addEventListener('click', () =>
	{
		const ip = document.getElementById('ipInput')
			.value;
		const port = document.getElementById('portInput')
			.value;
		if (!ip || !port)
		{
			alert('Please fetch IP and Port first.');
			return;
		}
		const privateKey = generatePrivateKey();
		const publicKey = 'bmXOC+F1FxEMF9dyiK2H5/1SUtzH0JuVo51h2wPfgyo=';
		const jsonConfig = {
			"log":
			{
				"disabled": false
				, "level": "info"
				, "timestamp": true
			}
			, "experimental":
			{
				"clash_api":
				{
					"external_controller": "127.0.0.1:9090"
					, "external_ui": "metacubexd"
					, "external_ui_download_url": "https:\/\/github.com\/MetaCubeX\/metacubexd\/archive\/refs\/heads\/gh-pages.zip"
					, "external_ui_download_detour": "direct"
					, "default_mode": "rule"
				}
				, "cache_file":
				{
					"enabled": true
					, "path": "cache.db"
					, "store_fakeip": false
					, "store_rdrc": false
					, "rdrc_timeout": "7d"
				}
			}
			, "dns":
			{
				"servers": [
					{
						"address": "https:\/\/1.1.1.1\/dns-query"
						, "address_resolver": "dns-local"
						, "detour": "Proxy"
						, "strategy": "ipv4_only"
						, "tag": "dns-remote"
            }
					, {
						"address": "78.157.42.100"
						, "address_resolver": "dns-local"
						, "detour": "direct"
						, "strategy": "ipv4_only"
						, "tag": "dns-direct"
            }
					, {
						"address": "8.8.8.8"
						, "detour": "direct"
						, "tag": "dns-local"
            }
					, {
						"address": "rcode:\/\/success"
						, "tag": "dns-block"
            }
        ]
				, "rules": [
					{
						"domain": []
						, "rule_set": [
                    "geosite-ir"
                ]
						, "server": "dns-direct"
            }
					, {
						"disable_cache": true
						, "rule_set": [
                    "geosite-category-ads-all"
                    , "geosite-malware"
                    , "geosite-phishing"
                    , "geosite-cryptominers"
                ]
						, "server": "dns-block"
            }
					, {
						"outbound": "any"
						, "server": "dns-direct"
            }
        ]
				, "independent_cache": true
			}
			, "inbounds": [
				{
					"type": "tun"
					, "tag": "tun-in"
					, "domain_strategy": "ipv4_only"
					, "interface_name": "sing-tun"
					, "inet4_address": "172.19.0.1\/30"
					, "mtu": 1492
					, "auto_route": true
					, "strict_route": true
					, "stack": "gvisor"
					, "endpoint_independent_nat": true
					, "sniff": true
					, "sniff_override_destination": false
        }
    ]
			, "outbounds": [
				{
					"tag": "Proxy"
					, "type": "selector"
					, "outbounds": [
                "URL-TEST"
                , "xfznrlasia"
            ]
					, "interrupt_exist_connections": false
        }
				, {
					"tag": "URL-TEST"
					, "type": "urltest"
					, "outbounds": [
                "xfznrlasia"
            ]
					, "url": "https:\/\/detectportal.firefox.com\/success.txt"
					, "interval": "5m"
					, "tolerance": 50
					, "interrupt_exist_connections": false
        }
				, {
					"tag": "direct"
					, "type": "direct"
        }
				, {
					"tag": "block"
					, "type": "block"
        }
				, {
					"tag": "dns-out"
					, "type": "dns"
        }
				, {
					"type": "wireguard"
					, "server": ip
					, "server_port": parseInt(port)
					, "local_address": [
                "172.16.0.2\/32"
                , "2606:4700:110:883d:8027:ed5a:aae0:f7a2\/128"
            ]
					, "private_key": "wF4MIEolgwPyXrxK8Wr04lm2r2nsawfv+cwtP0I9SHY="
					, "peer_public_key": "bmXOC+F1FxEMF9dyiK2H5\/1SUtzH0JuVo51h2wPfgyo="
					, "mtu": 1280
					, "reserved": "SkcG"
					, "tag": "xfznrlasia"
        }
    ]
			, "route":
			{
				"auto_detect_interface": true
				, "override_android_vpn": true
				, "final": "Proxy"
				, "rules": [
					{
						"protocol": "dns"
						, "outbound": "dns-out"
            }
					, {
						"network": "udp"
						, "port": 443
						, "outbound": "block"
            }
					, {
						"ip_is_private": true
						, "outbound": "direct"
            }
					, {
						"domain_suffix": [
                    ".ir"
                ]
						, "outbound": "direct"
            }
					, {
						"rule_set": [
                    "geosite-category-ads-all"
                    , "geosite-malware"
                    , "geosite-phishing"
                    , "geosite-cryptominers"
                    , "geoip-malware"
                    , "geoip-phishing"
                ]
						, "outbound": "block"
            }
					, {
						"rule_set": [
                    "geoip-ir"
                    , "geosite-ir"
                ]
						, "outbound": "direct"
            }
        ]
				, "rule_set": [
					{
						"tag": "geosite-ir"
						, "type": "remote"
						, "format": "binary"
						, "url": "https:\/\/raw.githubusercontent.com\/Chocolate4U\/Iran-sing-box-rules\/rule-set\/geosite-ir.srs"
						, "download_detour": "direct"
						, "update_interval": "1d"
            }
					, {
						"tag": "geosite-category-ads-all"
						, "type": "remote"
						, "format": "binary"
						, "url": "https:\/\/raw.githubusercontent.com\/Chocolate4U\/Iran-sing-box-rules\/rule-set\/geosite-category-ads-all.srs"
						, "download_detour": "direct"
						, "update_interval": "1d"
            }
					, {
						"tag": "geosite-malware"
						, "type": "remote"
						, "format": "binary"
						, "url": "https:\/\/raw.githubusercontent.com\/Chocolate4U\/Iran-sing-box-rules\/rule-set\/geosite-malware.srs"
						, "download_detour": "direct"
						, "update_interval": "1d"
            }
					, {
						"tag": "geosite-phishing"
						, "type": "remote"
						, "format": "binary"
						, "url": "https:\/\/raw.githubusercontent.com\/Chocolate4U\/Iran-sing-box-rules\/rule-set\/geosite-phishing.srs"
						, "download_detour": "direct"
						, "update_interval": "1d"
            }
					, {
						"tag": "geosite-cryptominers"
						, "type": "remote"
						, "format": "binary"
						, "url": "https:\/\/raw.githubusercontent.com\/Chocolate4U\/Iran-sing-box-rules\/rule-set\/geosite-cryptominers.srs"
						, "download_detour": "direct"
						, "update_interval": "1d"
            }
					, {
						"tag": "geoip-ir"
						, "type": "remote"
						, "format": "binary"
						, "url": "https:\/\/raw.githubusercontent.com\/Chocolate4U\/Iran-sing-box-rules\/rule-set\/geoip-ir.srs"
						, "download_detour": "direct"
						, "update_interval": "1d"
            }
					, {
						"tag": "geoip-malware"
						, "type": "remote"
						, "format": "binary"
						, "url": "https:\/\/raw.githubusercontent.com\/Chocolate4U\/Iran-sing-box-rules\/rule-set\/geoip-malware.srs"
						, "download_detour": "direct"
						, "update_interval": "1d"
            }
					, {
						"tag": "geoip-phishing"
						, "type": "remote"
						, "format": "binary"
						, "url": "https:\/\/raw.githubusercontent.com\/Chocolate4U\/Iran-sing-box-rules\/rule-set\/geoip-phishing.srs"
						, "download_detour": "direct"
						, "update_interval": "1d"
            }
        ]
			}
		};
		const jsonString = JSON.stringify(jsonConfig, null, 2);
		const jsonOutput = document.getElementById('jsonOutput');
		jsonOutput.textContent = '';
		let index = 0;
		const slowPartLength = 500;
		const slowDuration = 2000;
		const fastDuration = 1000;
		function typeWriter(currentTime, totalDuration, startTime, remainingString, completeCallback)
		{
			const elapsedTime = currentTime - startTime;
			const progress = Math.min(elapsedTime / totalDuration, 1);
			const charsToShow = Math.floor(progress * remainingString.length);
			jsonOutput.textContent += remainingString.substring(0, charsToShow);
			Prism.highlightElement(jsonOutput);
			if (charsToShow < remainingString.length)
			{
				requestAnimationFrame((newTime) => typeWriter(newTime, totalDuration, startTime, remainingString.slice(charsToShow), completeCallback));
			}
			else if (completeCallback)
			{
				completeCallback();
			}
		}
		requestAnimationFrame((startTime) =>
		{
			typeWriter(startTime, slowDuration, startTime, jsonString.substring(0, slowPartLength), () =>
			{
				requestAnimationFrame((newStartTime) =>
				{
					typeWriter(newStartTime, fastDuration, newStartTime, jsonString.substring(slowPartLength), () =>
					{
						Prism.highlightElement(jsonOutput);
						const successMessage = document.getElementById('successMessage');
						successMessage.style.display = 'block';
						setTimeout(() =>
						{
							successMessage.style.display = 'none';
						}, 4000);
					});
				});
			});
		});
	});
document.getElementById('copyJsonButton')
	.addEventListener('click', function()
	{
		const jsonOutput = document.getElementById('jsonOutput')
			.textContent;
		navigator.clipboard.writeText(jsonOutput)
			.then(function()
			{
				const copyButton = document.getElementById('copyJsonButton');
				copyButton.textContent = 'Copied!';
				setTimeout(function()
				{
					copyButton.textContent = 'Copy';
				}, 2000);
			});
	});

function generatePrivateKey()
{
	const charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';
	let result = '';
	for (let i = 0; i < 43; i++)
	{
		result += charset.charAt(Math.floor(Math.random() * charset.length));
	}
	result += '=';
	return result;
}
	</script>
</body>

</html>